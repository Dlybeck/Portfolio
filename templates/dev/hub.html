{% extends "shared/page.html" %}

{% block title %}
    <title>Dev | David Lybeck</title>
{% endblock %}

{% block content %}
<div class="container">
    <h2 id="location">Dev Environment</h2>

    <div class="section">
        <p>Remote development environment with secure access to OpenCode AI and VS Code.</p>
    </div>

    <div class="section">
        <h3>ü§ñ OpenCode AI</h3>
        <p>AI-powered coding assistant with oh-my-opencode (omo) agents. Chat interface optimized for mobile and desktop.</p>
        <a class="link internal-link" href="https://opencode.davidlybeck.com" target="_blank">Open OpenCode ‚Üí</a>
    </div>

    <div class="section">
        <h3>üìÅ VS Code</h3>
        <p>Full persistent IDE for file editing, code browsing, and viewing images/complex files.</p>
        <a class="link internal-link" href="/dev/vscode" target="_blank">Open VS Code Editor ‚Üí</a>
    </div>

    <div class="section">
        <h3>‚ö° Proxmox Host</h3>
        <p>Wake the bare-metal Proxmox host via Wake-on-LAN when it is powered off.</p>
        <button id="wol-btn" onclick="sendWol()" style="
            background: var(--accent-blue);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s, opacity 0.2s;
        ">Wake Proxmox</button>
        <p id="wol-status" style="margin-top: 8px; font-size: 13px; min-height: 1.4em;"></p>
        <a href="{{ proxmox_url }}" target="_blank" style="
            display: inline-block;
            margin-top: 12px;
            font-size: 12px;
            color: var(--text-muted);
            text-decoration: none;
        " onmouseover="this.style.color='var(--accent-blue)'"
           onmouseout="this.style.color='var(--text-muted)'">Proxmox console (debug)</a>
    </div>
</div>

<script>
async function sendWol() {
    const btn = document.getElementById("wol-btn");
    const status = document.getElementById("wol-status");

    btn.disabled = true;
    btn.style.opacity = "0.6";
    btn.textContent = "Sending...";
    status.textContent = "";
    status.style.color = "";

    try {
        const res = await fetch("/dev/wol", { method: "POST" });
        if (res.ok) {
            btn.textContent = "Sent";
            status.textContent = "Magic packet sent. The host should wake within a few seconds.";
            status.style.color = "var(--success-color)";
            // Reset button after 4s
            setTimeout(() => {
                btn.textContent = "Wake Proxmox";
                btn.disabled = false;
                btn.style.opacity = "1";
                status.textContent = "";
            }, 4000);
        } else {
            const data = await res.json();
            btn.textContent = "Failed";
            status.textContent = data.detail || "Unknown error";
            status.style.color = "var(--danger-color)";
            btn.disabled = false;
            btn.style.opacity = "1";
        }
    } catch (e) {
        btn.textContent = "Failed";
        status.textContent = "Network error ‚Äî check your connection.";
        status.style.color = "var(--danger-color)";
        btn.disabled = false;
        btn.style.opacity = "1";
    }
}
</script>
{% endblock %}
